<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
</head>
<body>
  <!-- <iframe
  id="iframe1"
  width="800"
  height="400"
  seamless
  frameBorder="0"
  scrolling="no"
  src=""></iframe>  -->
  
  <div id="iframe1"></div>

  <iframe
  width="600"
  height="400"
  seamless
  frameBorder="0"
  scrolling="no"
  src="http://10.30.250.16:8088/talbi/explore/?form_data=%7B%22datasource%22%3A%22206__table%22%2C%22viz_type%22%3A%22dist_bar%22%2C%22slice_id%22%3A212%2C%22granularity_sqla%22%3Anull%2C%22time_grain_sqla%22%3Anull%2C%22since%22%3A%22100+years+ago%22%2C%22until%22%3A%22now%22%2C%22metrics%22%3A%5B%7B%22expressionType%22%3A%22SQL%22%2C%22sqlExpression%22%3A%22TRUNCATE%28SUM%28bk_dr%29%2F3600000%2C+1%29%22%2C%22column%22%3Anull%2C%22aggregate%22%3Anull%2C%22hasCustomLabel%22%3Atrue%2C%22fromFormData%22%3Atrue%2C%22label%22%3A%22%E5%A4%87%E8%AF%BE%E6%97%B6%E9%95%BF%22%2C%22optionName%22%3A%22metric_una09ziet6_bs9olsjaykv%22%7D%5D%2C%22adhoc_filters%22%3A%5B%7B%22expressionType%22%3A%22SIMPLE%22%2C%22subject%22%3A%22bk_dr%22%2C%22operator%22%3A%22%3E%22%2C%22comparator%22%3A%220%22%2C%22clause%22%3A%22WHERE%22%2C%22sqlExpression%22%3Anull%2C%22fromFormData%22%3Atrue%2C%22filterOptionName%22%3A%22filter_l5kq3cmrnim_z8u3tph81c%22%7D%5D%2C%22groupby%22%3A%5B%22crawl_date%22%5D%2C%22columns%22%3A%5B%5D%2C%22order_by_cols%22%3A%5B%22%5B%5C%22crawl_date%5C%22%2C+false%5D%22%5D%2C%22row_limit%22%3A%225%22%2C%22contribution%22%3Afalse%2C%22color_scheme%22%3A%22bnbColors%22%2C%22show_legend%22%3Atrue%2C%22show_bar_value%22%3Afalse%2C%22bar_stacked%22%3Afalse%2C%22order_bars%22%3Atrue%2C%22y_axis_format%22%3A%22.3s%22%2C%22y_axis_label%22%3A%22%22%2C%22show_controls%22%3Afalse%2C%22direction%22%3A%22vertical%22%2C%22x_axis_label%22%3A%22%22%2C%22bottom_margin%22%3A%22auto%22%2C%22x_ticks_layout%22%3A%22auto%22%2C%22reduce_x_ticks%22%3Afalse%2C%22limit%22%3A%220%22%2C%22url_params%22%3A%7B%7D%2C%22where%22%3A%22%22%2C%22having%22%3A%22%22%2C%22having_filters%22%3A%5B%5D%2C%22filters%22%3A%5B%7B%22col%22%3A%22bk_dr%22%2C%22op%22%3A%22%3E%22%2C%22val%22%3A%220%22%7D%5D%7D&standalone=true&height=400"
>
</iframe>

<iframe
width="600"
height="400"
seamless
frameBorder="0"
scrolling="no"
src="http://10.30.250.16:8088/talbi/explore/?form_data=%7B%22datasource%22%3A%22206__table%22%2C%22viz_type%22%3A%22dist_bar%22%2C%22slice_id%22%3A212%2C%22granularity_sqla%22%3Anull%2C%22time_grain_sqla%22%3Anull%2C%22since%22%3A%22100+years+ago%22%2C%22until%22%3A%22now%22%2C%22metrics%22%3A%5B%7B%22expressionType%22%3A%22SQL%22%2C%22sqlExpression%22%3A%22TRUNCATE%28SUM%28bk_dr%29%2F3600000%2C+1%29%22%2C%22column%22%3Anull%2C%22aggregate%22%3Anull%2C%22hasCustomLabel%22%3Atrue%2C%22fromFormData%22%3Atrue%2C%22label%22%3A%22%E5%A4%87%E8%AF%BE%E6%97%B6%E9%95%BF%22%2C%22optionName%22%3A%22metric_una09ziet6_bs9olsjaykv%22%7D%5D%2C%22adhoc_filters%22%3A%5B%7B%22expressionType%22%3A%22SIMPLE%22%2C%22subject%22%3A%22bk_dr%22%2C%22operator%22%3A%22%3E%22%2C%22comparator%22%3A%220%22%2C%22clause%22%3A%22WHERE%22%2C%22sqlExpression%22%3Anull%2C%22fromFormData%22%3Atrue%2C%22filterOptionName%22%3A%22filter_l5kq3cmrnim_z8u3tph81c%22%7D%5D%2C%22groupby%22%3A%5B%22crawl_date%22%5D%2C%22columns%22%3A%5B%5D%2C%22order_by_cols%22%3A%5B%22%5B%5C%22crawl_date%5C%22%2C+false%5D%22%5D%2C%22row_limit%22%3A%225%22%2C%22contribution%22%3Afalse%2C%22color_scheme%22%3A%22bnbColors%22%2C%22show_legend%22%3Atrue%2C%22show_bar_value%22%3Afalse%2C%22bar_stacked%22%3Afalse%2C%22order_bars%22%3Atrue%2C%22y_axis_format%22%3A%22.3s%22%2C%22y_axis_label%22%3A%22%22%2C%22show_controls%22%3Afalse%2C%22direction%22%3A%22vertical%22%2C%22x_axis_label%22%3A%22%22%2C%22bottom_margin%22%3A%22auto%22%2C%22x_ticks_layout%22%3A%22auto%22%2C%22reduce_x_ticks%22%3Afalse%2C%22limit%22%3A%220%22%2C%22url_params%22%3A%7B%7D%2C%22where%22%3A%22%22%2C%22having%22%3A%22%22%2C%22having_filters%22%3A%5B%5D%2C%22filters%22%3A%5B%7B%22col%22%3A%22bk_dr%22%2C%22op%22%3A%22%3E%22%2C%22val%22%3A%220%22%7D%5D%7D&standalone=true&height=400"
>
</iframe>
</body>

<script>

let data = {
    "datasource": "206__table",
    "viz_type": "dist_bar",
    "slice_id": 212,
    "granularity_sqla": null,
    "time_grain_sqla": null,
    "since": "100+years+ago",
    "until": "now",
    "metrics": [
        {
            "expressionType": "SQL",
            "sqlExpression": "TRUNCATE(SUM(bk_dr)/3600000,+1)",
            "column": null,
            "aggregate": null,
            "hasCustomLabel": true,
            "fromFormData": true,
            "label": "备课时长",
            "optionName": "metric_una09ziet6_bs9olsjaykv"
        }
    ],
    "adhoc_filters": [
        {
            "expressionType": "SIMPLE",
            "subject": "bk_dr",
            "operator": ">",
            "comparator": "0",
            "clause": "WHERE",
            "sqlExpression": null,
            "fromFormData": true,
            "filterOptionName": "filter_l5kq3cmrnim_z8u3tph81c"
        }
    ],
    "groupby": [
        "crawl_date"
    ],
    "columns": [],
    "order_by_cols": [
        "[\"crawl_date\",+false]"
    ],
    "row_limit": "5",
    "contribution": false,
    "color_scheme": "bnbColors",
    "show_legend": true,
    "show_bar_value": false,
    "bar_stacked": false,
    "order_bars": true,
    "y_axis_format": ".3s",
    "y_axis_label": "",
    "show_controls": false,
    "direction": "vertical",
    "x_axis_label": "",
    "bottom_margin": "auto",
    "x_ticks_layout": "auto",
    "reduce_x_ticks": false,
    "limit": "0",
    "url_params": {},
    "where": "",
    "having": "",
    "having_filters": [],
    "filters": [
        {
            "col": "bk_dr",
            "op": ">",
            "val": "0"
        }
    ]
}
let str = "%7B%22datasource%22%3A%22206__table%22%2C%22viz_type%22%3A%22dist_bar%22%2C%22slice_id%22%3A212%2C%22granularity_sqla%22%3Anull%2C%22time_grain_sqla%22%3Anull%2C%22since%22%3A%22100+years+ago%22%2C%22until%22%3A%22now%22%2C%22metrics%22%3A%5B%7B%22expressionType%22%3A%22SQL%22%2C%22sqlExpression%22%3A%22TRUNCATE%28SUM%28bk_dr%29%2F3600000%2C+1%29%22%2C%22column%22%3Anull%2C%22aggregate%22%3Anull%2C%22hasCustomLabel%22%3Atrue%2C%22fromFormData%22%3Atrue%2C%22label%22%3A%22%E5%A4%87%E8%AF%BE%E6%97%B6%E9%95%BF%22%2C%22optionName%22%3A%22metric_una09ziet6_bs9olsjaykv%22%7D%5D%2C%22adhoc_filters%22%3A%5B%7B%22expressionType%22%3A%22SIMPLE%22%2C%22subject%22%3A%22bk_dr%22%2C%22operator%22%3A%22%3E%22%2C%22comparator%22%3A%220%22%2C%22clause%22%3A%22WHERE%22%2C%22sqlExpression%22%3Anull%2C%22fromFormData%22%3Atrue%2C%22filterOptionName%22%3A%22filter_l5kq3cmrnim_z8u3tph81c%22%7D%5D%2C%22groupby%22%3A%5B%22crawl_date%22%5D%2C%22columns%22%3A%5B%5D%2C%22order_by_cols%22%3A%5B%22%5B%5C%22crawl_date%5C%22%2C+false%5D%22%5D%2C%22row_limit%22%3A%225%22%2C%22contribution%22%3Afalse%2C%22color_scheme%22%3A%22bnbColors%22%2C%22show_legend%22%3Atrue%2C%22show_bar_value%22%3Afalse%2C%22bar_stacked%22%3Afalse%2C%22order_bars%22%3Atrue%2C%22y_axis_format%22%3A%22.3s%22%2C%22y_axis_label%22%3A%22%22%2C%22show_controls%22%3Afalse%2C%22direction%22%3A%22vertical%22%2C%22x_axis_label%22%3A%22%22%2C%22bottom_margin%22%3A%22auto%22%2C%22x_ticks_layout%22%3A%22auto%22%2C%22reduce_x_ticks%22%3Afalse%2C%22limit%22%3A%220%22%2C%22url_params%22%3A%7B%7D%2C%22where%22%3A%22%22%2C%22having%22%3A%22%22%2C%22having_filters%22%3A%5B%5D%2C%22filters%22%3A%5B%7B%22col%22%3A%22bk_dr%22%2C%22op%22%3A%22%3E%22%2C%22val%22%3A%220%22%7D%5D%7D"
var str1 = JSON.parse(decodeURIComponent(str))
str1.filters[0].op = "<"
console.log(str1);

let url= "http://10.30.250.16:8088/talbi/explore/?form_data="
function setIframeSrc() {
    var s =url + encodeURIComponent(JSON.stringify(str1));
    console.log(s);
    let iframe = ` <iframe
  id="iframe1"
  width="800"
  height="400"
  seamless
  frameBorder="0"
  scrolling="no"
  src="${s}"></iframe> `
  document.querySelector('#iframe1').innerHTML = iframe
  
    // var iframe1 = document.getElementById('iframe1');
    // iframe1.src = s
    // iframe1.src = "http://10.30.250.16:8088/talbi/explore/?form_data=%7B%22datasource%22%3A%22206__table%22%2C%22viz_type%22%3A%22dist_bar%22%2C%22slice_id%22%3A212%2C%22granularity_sqla%22%3Anull%2C%22time_grain_sqla%22%3Anull%2C%22since%22%3A%22100+years+ago%22%2C%22until%22%3A%22now%22%2C%22metrics%22%3A%5B%7B%22expressionType%22%3A%22SQL%22%2C%22sqlExpression%22%3A%22TRUNCATE%28SUM%28bk_dr%29%2F3600000%2C+1%29%22%2C%22column%22%3Anull%2C%22aggregate%22%3Anull%2C%22hasCustomLabel%22%3Atrue%2C%22fromFormData%22%3Atrue%2C%22label%22%3A%22%E5%A4%87%E8%AF%BE%E6%97%B6%E9%95%BF%22%2C%22optionName%22%3A%22metric_una09ziet6_bs9olsjaykv%22%7D%5D%2C%22adhoc_filters%22%3A%5B%7B%22expressionType%22%3A%22SIMPLE%22%2C%22subject%22%3A%22bk_dr%22%2C%22operator%22%3A%22%3E%22%2C%22comparator%22%3A%220%22%2C%22clause%22%3A%22WHERE%22%2C%22sqlExpression%22%3Anull%2C%22fromFormData%22%3Atrue%2C%22filterOptionName%22%3A%22filter_l5kq3cmrnim_z8u3tph81c%22%7D%5D%2C%22groupby%22%3A%5B%22crawl_date%22%5D%2C%22columns%22%3A%5B%5D%2C%22order_by_cols%22%3A%5B%22%5B%5C%22crawl_date%5C%22%2C+false%5D%22%5D%2C%22row_limit%22%3A%225%22%2C%22contribution%22%3Afalse%2C%22color_scheme%22%3A%22bnbColors%22%2C%22show_legend%22%3Atrue%2C%22show_bar_value%22%3Afalse%2C%22bar_stacked%22%3Afalse%2C%22order_bars%22%3Atrue%2C%22y_axis_format%22%3A%22.3s%22%2C%22y_axis_label%22%3A%22%22%2C%22show_controls%22%3Afalse%2C%22direction%22%3A%22vertical%22%2C%22x_axis_label%22%3A%22%22%2C%22bottom_margin%22%3A%22auto%22%2C%22x_ticks_layout%22%3A%22auto%22%2C%22reduce_x_ticks%22%3Afalse%2C%22limit%22%3A%220%22%2C%22url_params%22%3A%7B%7D%2C%22where%22%3A%22%22%2C%22having%22%3A%22%22%2C%22having_filters%22%3A%5B%5D%2C%22filters%22%3A%5B%7B%22col%22%3A%22bk_dr%22%2C%22op%22%3A%22%3E%22%2C%22val%22%3A%220%22%7D%5D%7D&standalone=true&height=400";
}
setTimeout(setIframeSrc, 5);

</script>
</html>